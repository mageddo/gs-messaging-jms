CREATE TABLE IF NOT EXISTS WITHDRAW (
	IDT_WITHDRAW INT AUTO_INCREMENT,
	IND_TYPE CHAR(1) NOT NULL, -- B => BANK, R => RFID
	IND_STATUS CHAR(1) NOT NULL, -- O => OPEN, P => PROCESSING, C => COMPLETED, E => ERROR
	NUM_VALUE DECIMAL(10, 2) UNIQUE,
	DAT_CREATION TIMESTAMP NOT NULL,
	DAT_UPDATE TIMESTAMP NOT NULL,
	PRIMARY KEY(IDT_WITHDRAW)
)

SELECT * FROM DESTINATION_PARAMETER;

DROP TABLE WITHDRAW;

INSERT INTO WITHDRAW 
	(IDT_WITHDRAW, IND_TYPE, NUM_VALUE, DAT_CREATION, DAT_UPDATE) VALUES 
	(?, ?, ?, ?, ?)


SELECT * FROM WITHDRAW;


UPDATE WITHDRAW SET IND_STATUS = 'O' WHERE IND_STATUS = 'P'

SELECT COUNT(1) FROM WITHDRAW WHERE IND_STATUS = 'P';

SELECT COUNT(1), IND_TYPE FROM WITHDRAW
	GROUP BY IND_TYPE;

SELECT COUNT(1), IND_STATUS FROM WITHDRAW
	GROUP BY IND_STATUS;

UPDATE WITHDRAW SET IND_STATUS = 'P' WHERE IDT_WITHDRAW = ?


SELECT 
	IDT_WITHDRAW, IND_TYPE,
	IND_STATUS, NUM_VALUE,
	DAT_CREATION, DAT_UPDATE
FROM WITHDRAW
WHERE IND_STATUS = 'O'
LIMIT 0, 1000


SELECT * FROM USER
--LIMIT 0,1000
;

SELECT * FROM USER 
WHERE STATUS = 'P' OR (STATUS = 'Q' AND TIMESTAMPDIFF('MINUTE', DAT_ENQUEUED, CURRENT_TIMESTAMP()) > 30)
LIMIT 0, 1000


SELECT SYSDATE FROM DUAL;

SELECT TIMESTAMPDIFF('MINUTE', TO_TIMESTAMP('2017-05-31 00:49', 'yyyy-MM-dd HH24-mi'), CURRENT_TIMESTAMP()) FROM DUAL;


SELECT * FROM WITHDRAW WHERE DAT_CREATION > '2017-05-31 00:49:43.000';

SELECT COUNT(1), STATUS FROM USER
	GROUP BY STATUS


SELECT COUNT(1) FROM USER;


UPDATE USER SET STATUS='P' WHERE STATUS='Q'